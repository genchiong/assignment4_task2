---
title: "Juvenile Snowshoe Hares in Bonanza Creek LTER: exploratory report"
author: "Genevieve Chiong"
date: "11/15/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(lubridate)
library(janitor)
library(here)
library(kableExtra)
library(effsize)
library(broom)
library(ggbeeswarm)
```

### 1. Introduction

 you will explore the counts and sizes of juvenile snowshoe hares recorded from 1998 - 2012. 

Data citation: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14



### 2. Data and analyses





### 3. Exploratory Findings 

```{r}
# Read in the data 
bonanza_hares <- read_csv(here("data","bonanza_hares.csv"))
```

#### A) Annual juvenile hare trap counts 

Here I count the total number of juvenile hare trappings during each year of the study and create a data visualization of the counts by year. All grid sites were included. 

```{r}
juvenile_hares <- bonanza_hares %>% 
  filter(weight >= 0,
         age == "j") %>% 
  mutate(sex_full = case_when(
    sex == "f" ~ "Female",
    sex == "m" ~ "Male"))

juvenile_count <- juvenile_hares %>% 
  mutate(date_new = mdy(date)) %>% 
  mutate(year_new = year(date_new)) %>% 
  count(year_new)

kable(juvenile_count,
      col.names = c("Year",
                    "Sample Size (n)")) %>% 
  kable_styling(full_width = FALSE)
```
**Table 1.** The total number of juvenile hare trappings from all sites counted during each year of the study from 1999-2012. Data: Kielland et al. 2017.

```{r fig.cap = "**Figure 1.** Annual juvenile hare trap counts: The total number of juvenile hare trappings between 1999-2012. Data: Kielland et al. 2017."} 

ggplot(data = juvenile_count) + 
  geom_col(aes(x = year_new,
               y = n),
           fill = "cadetblue", 
           color = "black") +
  labs(x = "Year",
       y = "Number of Juvenile Hare Trappings") +
  theme_minimal() +
  scale_x_continuous(breaks = 1999:2012)
```

```{r}
juvenile_count %>% 
  summarize(
    mean_count = mean(n),
    median_count = median(n))
```

The maximum count of juvenile hare trappings was in 1999 with a count of 126, and the minimum was in 2002 and 2009, which both had zero juvenile hare trappings. Since the first year of the study in 1999 with the highest amount of hare trappings, observations showed a notable decline throughout the years to 2012. The mean annual number of juvenile hares trapped was 31.5 and the median was 18.5. To standardize the juvenile hare population in future analyses, I would suggest that in future analyses that the count be normalized to take into consideration the number of days and number of traps not being equal each year of the study. 

#### B) Visualize juvenile hare weights 

Here, I ..... 


Create a finalized data visualization (or visualizations) in which you compare **juvenile hare weights by sex and site (grid)** (ignore other variables). You should include groups where these variables are not recorded (`NA`). Include finalized figure captions below your visualization(s).

Then, in 2 - 3 sentences below your visualization(s) describe in text the main takeaways that you would want the audience to understand from your figures.
sex and island are not included as variables here, but should be investigated moving forward. 

Sex and sampling site are the only two variables 

```{r fig.cap = "**Figure 3.** Comparisons of juvenile hare weights (g) by sex (female, male, and NA = not recorded) and sampling site (Bonanza Black Spruce, Bonanza Mature, and Bonanza Riparian). Red (female), slate (male), and orange (NA = not recorded) points indicate individual observations for weight (g) of a juvenile snowshoe hare. Box endpoints indicate the 25th and 75th percentile values; the black line and black point within the box indicate the median and mean value for each species, respectively. Data: Kielland et al. 2017."}

site_labels <- c(bonbs = "Bonanza Black Spruce",
                 bonmat = "Bonanza Mature",
                 bonrip = "Bonanza Riparian")

ggplot(data = juvenile_hares,
       aes(x = sex_full,
           y = weight)) +
  geom_beeswarm(aes(color = sex_full)) + 
  scale_color_manual(values = c("palevioletred","darkslategray4"), 
                     na.value = "orange") +
  geom_boxplot(fill = NA, 
               width = 0.5, 
               outlier.color = NA) + 
  stat_summary(fun = mean, 
               geom = "point", 
               shape = 20, 
               size = 4, 
               color = "black", 
               fill = "black") +
  facet_wrap(~grid,
             labeller = labeller(grid = site_labels)) +
  theme_minimal() +
  labs(x = "Sex",
       y = "Juvenile Hare Weights (g)")
```
On average in the Bonanza Mature and Bonanza Riparian sampling sites, male juvenile hares weighed more than female juvenile hares and juvenile hares whose sex was not recorded. In the Bonbs site, female juvenile hares had an average greater weight, but this may be due to the smaller sample size of male juvenile hares. 


### iii) Juvenile weight comparison (male & female snowshoe hares)

```{r}
juvenile_sex_weight <- juvenile_hares %>% 
  filter(sex_full == "Female" | sex_full == "Male")

ggplot(data = juvenile_sex_weight,
       aes(x = weight)) + 
  geom_histogram(bins = 10) +
  facet_wrap(~sex_full) +
  labs(x = "Weight (g)",
       y = "Number of Juvenile Snowshoe Hare Trappings")
```

```{r}
ggplot(data = juvenile_sex_weight, 
       aes(sample = weight)) + 
  geom_qq() +
  facet_wrap(~sex_full)
```

```{r}
sex_weight_stats <- juvenile_sex_weight %>% 
  filter(weight > 0, weight < 2000) %>% 
  group_by(sex) %>% 
  summarize(mean_weight = mean(weight),
            sd_weight = sd(weight),
            sample_size = n())

kable(sex_weight_stats,
      col.names = c("Sex",
                    "Mean Weight (g)",
                    "Weight Standard Deviation (g)",
                    "Sample Size (n)"),
      caption = "Table 2: Statistic Summary Comparing Juvenile Female vs Male Snowshoe Hares") %>% 
  kable_styling(full_width = FALSE)

```

```{r}
juvenile_female_sample <- juvenile_sex_weight %>% 
  filter(sex == "f") %>% 
  pull(weight)

juvenile_male_sample <- juvenile_sex_weight %>% 
  filter(sex == "m") %>% 
  pull(weight)

t.test(x = juvenile_female_sample, y = juvenile_male_sample)
```

```{r}
cohen.d(juvenile_female_sample, juvenile_male_sample,
        na.rm = TRUE)
```
#### Main Takeaways
Means comparison 
P-value = 
Actual differnece in means = 
Effect size = small 
Outcome of two-sample t-test 


A finalized table containing the mean, standard deviation, and sample size for male and female juvenile snowshoe hares, with a table caption (remember, this is placed *above* the table in your report)
A 2 - 3 sentence comprehensive statement of the means comparison, including at least:
The actual difference in means
Effect size (Cohen's *d*)
Outcome of a two-sample t-test


### iv) Relationship between juvenile weight and hind foot length

```{r}
hindft_length <- bonanza_hares %>% 
  filter(age == "j") 

ggplot(data = hindft_length,
       aes(x = hindft,
           y = weight)) +
  geom_point() + 
  labs(x = "Juvenile Snowshoe Hare Hind Foot Length (mm)",
       y = "Weight (g)",
       title = "Relationship between hind foot length and juvenile weight")
```


```{r}
hindft_weight_lm <- lm(weight ~ hindft, data = hindft_length)

summary(hindft_weight_lm)
```


```{r}
hindft_weight_lm_tidy <- broom::tidy(hindft_weight_lm)

hindft_weight_int <- hindft_weight_lm_tidy$estimate[1]
hindft_weight_int

hindft_weight_coef <- hindft_weight_lm_tidy$estimate[2]
hindft_weight_coef

hindft_weight_lm_out <- broom::glance(hindft_weight_lm)
hindft_weight_lm_out
```


```{r}
plot(hindft_weight_lm)
```

```{r}
hares_cor <- cor.test(hindft_length$hindft,
                      hindft_length$weight)
hares_cor
```

```{r}
ggplot(data = hindft_length,
       aes(x = hindft,
           y = weight)) +
  geom_point(size = 2) +
  geom_smooth(method = "lm",
              color = "red",
              size = 0.5,
              fill = "gray10",
              alpha = 0.5) +
  theme_light() +
  ggpubr::stat_regline_equation(label.x = 75, label.y = 1200)
```

#### Main Takewaways 





### Summary




### Citations





